{"ast":null,"code":"import{useState,useEffect,useRef}from\"react\";import{TextField,Container,Typography,Box}from\"@mui/material\";import{getMyNews,updateNews}from\"../api/Api\";import{ToastContainer,toast,Slide}from\"react-toastify\";import{useParams,useNavigate}from\"react-router-dom\";import Button from\"react-bootstrap/Button\";// Import button dari Bootstrap\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function FormUpdateBerita(){const{id}=useParams();// Mengambil id dari URL parameter\nconst[title,setTitle]=useState(\"\");const[content,setContent]=useState(\"\");const[image,setImage]=useState(null);const[imagePreview,setImagePreview]=useState(null);const fileInputRef=useRef(null);const navigate=useNavigate();// Fetch berita berdasarkan id\nuseEffect(()=>{const fetchData=async()=>{try{const response=await getMyNews();if(response.data&&Array.isArray(response.data.data)){const berita=response.data.data.find(b=>b.id.toString()===id);// Pastikan id adalah string\nif(berita){setTitle(berita.title);setContent(berita.content);setImage(null);setImagePreview(berita.image);}else{console.error(\"Berita tidak ditemukan dengan id:\",id);}}else{console.error(\"Data yang diterima bukan array:\",response.data);}}catch(error){console.error(\"Error fetching news:\",error);}};fetchData();},[id]);const updateBerita=async e=>{e.preventDefault();try{const payload=new FormData();payload.append(\"title\",title);payload.append(\"content\",content);if(image){payload.append(\"image\",image);}await updateNews(id,payload);toast.success(\"Berita berhasil diperbarui!\",{position:\"top-right\",hideProgressBar:true,closeOnClick:true,pauseOnHover:true,draggable:true,transition:Slide,autoClose:2000,theme:\"light\"});setTitle(\"\");setContent(\"\");setImage(null);setImagePreview(null);setTimeout(()=>navigate(\"/manajemen-berita\"),2000);}catch(error){var _error$response,_error$response$data,_error$response2;console.error(\"Error saat memperbarui berita:\",((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||((_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.data)||error);toast.error(\"Gagal memperbarui berita.\");}};const handleImageChange=e=>{const file=e.target.files[0];setImage(file);const reader=new FileReader();reader.onloadend=()=>{setImagePreview(reader.result);};if(file){reader.readAsDataURL(file);}else{setImagePreview(null);}};return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",align:\"center\",gutterBottom:true,children:\"PERBARUI BERITA\"}),/*#__PURE__*/_jsxs(Box,{component:\"form\",onSubmit:updateBerita,noValidate:true,sx:{mt:3},children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Judul Berita\",value:title,onChange:e=>setTitle(e.target.value),margin:\"normal\"}),/*#__PURE__*/_jsxs(Button,{variant:\"primary\",as:\"label\",style:{marginTop:\"16px\",marginBottom:\"16px\"},children:[\"Unggah Foto\",/*#__PURE__*/_jsx(\"input\",{type:\"file\",hidden:true,onChange:handleImageChange,ref:fileInputRef})]}),imagePreview&&/*#__PURE__*/_jsxs(Box,{sx:{mt:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:\"Preview Foto\"}),/*#__PURE__*/_jsx(\"img\",{src:imagePreview,alt:\"Preview\",style:{width:\"300px\",maxHeight:\"500px\"}})]}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Deskripsi Berita\",multiline:true,rows:3,value:content,onChange:e=>setContent(e.target.value),margin:\"normal\"}),/*#__PURE__*/_jsx(Box,{sx:{display:\"flex\",justifyContent:\"flex-end\",mt:3},children:/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"primary\",children:\"Simpan Perubahan\"})})]}),/*#__PURE__*/_jsx(ToastContainer,{})]});}export default FormUpdateBerita;","map":{"version":3,"names":["useState","useEffect","useRef","TextField","Container","Typography","Box","getMyNews","updateNews","ToastContainer","toast","Slide","useParams","useNavigate","Button","jsx","_jsx","jsxs","_jsxs","FormUpdateBerita","id","title","setTitle","content","setContent","image","setImage","imagePreview","setImagePreview","fileInputRef","navigate","fetchData","response","data","Array","isArray","berita","find","b","toString","console","error","updateBerita","e","preventDefault","payload","FormData","append","success","position","hideProgressBar","closeOnClick","pauseOnHover","draggable","transition","autoClose","theme","setTimeout","_error$response","_error$response$data","_error$response2","message","handleImageChange","file","target","files","reader","FileReader","onloadend","result","readAsDataURL","children","variant","align","gutterBottom","component","onSubmit","noValidate","sx","mt","fullWidth","label","value","onChange","margin","as","style","marginTop","marginBottom","type","hidden","ref","src","alt","width","maxHeight","multiline","rows","display","justifyContent"],"sources":["/home/ubuntu/YARSI-Connect-Alumni-main/YARSI-Connect-Alumni-main/YARSI-Connect Alumni/front-end/src/components/FormUpdateBerita.js"],"sourcesContent":["import { useState, useEffect, useRef } from \"react\";\nimport {\n  TextField,\n  Container,\n  Typography,\n  Box,\n} from \"@mui/material\";\nimport { getMyNews, updateNews } from \"../api/Api\";\nimport { ToastContainer, toast, Slide } from \"react-toastify\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport Button from \"react-bootstrap/Button\"; // Import button dari Bootstrap\n\nfunction FormUpdateBerita() {\n  const { id } = useParams(); // Mengambil id dari URL parameter\n  const [title, setTitle] = useState(\"\");\n  const [content, setContent] = useState(\"\");\n  const [image, setImage] = useState(null);\n  const [imagePreview, setImagePreview] = useState(null);\n\n  const fileInputRef = useRef(null);\n  const navigate = useNavigate();\n\n  // Fetch berita berdasarkan id\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await getMyNews();\n        if (response.data && Array.isArray(response.data.data)) {\n          const berita = response.data.data.find((b) => b.id.toString() === id); // Pastikan id adalah string\n          if (berita) {\n            setTitle(berita.title);\n            setContent(berita.content);\n            setImage(null); \n            setImagePreview(berita.image); \n          } else {\n            console.error(\"Berita tidak ditemukan dengan id:\", id);\n          }\n        } else {\n          console.error(\"Data yang diterima bukan array:\", response.data);\n        }\n      } catch (error) {\n        console.error(\"Error fetching news:\", error);\n      }\n    };\n\n    fetchData();\n  }, [id]);\n\n  const updateBerita = async (e) => {\n    e.preventDefault();\n    try {\n      const payload = new FormData();\n      payload.append(\"title\", title);\n      payload.append(\"content\", content);\n      if (image) {\n        payload.append(\"image\", image); \n      }\n\n      await updateNews(id, payload); \n\n      toast.success(\"Berita berhasil diperbarui!\", {\n        position: \"top-right\",\n        hideProgressBar: true,\n        closeOnClick: true,\n        pauseOnHover: true,\n        draggable: true,\n        transition: Slide,\n        autoClose: 2000,\n        theme: \"light\",\n      });\n      setTitle(\"\");\n      setContent(\"\");\n      setImage(null);\n      setImagePreview(null);\n\n      setTimeout(() => navigate(\"/manajemen-berita\"), 2000);\n    } catch (error) {\n      console.error(\n        \"Error saat memperbarui berita:\",\n        error.response?.data?.message || error.response?.data || error\n      );\n      toast.error(\"Gagal memperbarui berita.\");\n    }\n  };\n\n  const handleImageChange = (e) => {\n    const file = e.target.files[0];\n    setImage(file);\n\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      setImagePreview(reader.result);\n    };\n\n    if (file) {\n      reader.readAsDataURL(file);\n    } else {\n      setImagePreview(null);\n    }\n  };\n\n  return (\n    <Container>\n      <Typography variant=\"h4\" align=\"center\" gutterBottom>\n        PERBARUI BERITA\n      </Typography>\n      <Box\n        component=\"form\"\n        onSubmit={updateBerita}\n        noValidate\n        sx={{ mt: 3 }}\n      >\n        <TextField\n          fullWidth\n          label=\"Judul Berita\"\n          value={title}\n          onChange={(e) => setTitle(e.target.value)}\n          margin=\"normal\"\n        />\n\n        <Button\n          variant=\"primary\"\n          as=\"label\"\n          style={{ marginTop: \"16px\", marginBottom: \"16px\" }}\n        >\n          Unggah Foto\n          <input\n            type=\"file\"\n            hidden\n            onChange={handleImageChange}\n            ref={fileInputRef}\n          />\n        </Button>\n\n        {imagePreview && (\n          <Box sx={{ mt: 2 }}>\n            <Typography variant=\"body1\">Preview Foto</Typography>\n            <img\n              src={imagePreview}\n              alt=\"Preview\"\n              style={{ width: \"300px\", maxHeight: \"500px\" }}\n            />\n          </Box>\n        )}\n\n        <TextField\n          fullWidth\n          label=\"Deskripsi Berita\"\n          multiline\n          rows={3}\n          value={content}\n          onChange={(e) => setContent(e.target.value)}\n          margin=\"normal\"\n        />\n\n        <Box sx={{ display: \"flex\", justifyContent: \"flex-end\", mt: 3 }}>\n          <Button type=\"submit\" variant=\"primary\">\n            Simpan Perubahan\n          </Button>\n        </Box>\n      </Box>\n      <ToastContainer />\n    </Container>\n  );\n}\n\nexport default FormUpdateBerita;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}